<!DOCTYPE html>
<html ng-app="mainApp">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>{{pageTitle || "app"}}</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link href="/styles/site.min.css" rel="stylesheet">
    [[var helpers = model.helpers;]] <!--get helper functions-->
  </head>
  <body>
    <div id="header">
      [[?model.navLinks && model.navLinks.length]]
      <div class="container">
        <div role="navigation" class="navbar navbar-default">
          <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
              </button>
              <a href="/" class="navbar-brand">白米兌換管理系統</a>
            </div>
            <div class="collapse navbar-collapse">
              <ul class="nav navbar-nav navbar-left">
                  [[~ model.navLinks:link]]
                  <li>
                    <a ui-sref=[[=link.state]]>[[=link.label]]</a>
                  </li>
                  [[~]]
              </ul>
              <ul class="nav navbar-nav navbar-right">
                [[?model.user]]
                [[var result= helpers.getKeystoneAttr('signout url');]]
                <li><a href=[[=result]]>Sign Out</a></li>
                [[?? true]]
                [[var result= helpers.getKeystoneAttr('signin url');]]
                <li><a href=[[=result]]>Sign In</a></li>
                [[?]]
              </ul>
            </div>
          </div>
        </div>
      </div>
      [[?]]
    </div>

    <div id="body">
      <div class="container">
        <my-ajax-msg></my-ajax-msg>
        <section ui-view></section>
      </div>
    </div>

    <div class="container">
      <div id="footer">
        <p>Powered by <a href="http://keystonejs.com" target="_blank">KeystoneJS</a>.</p>
      </div>
    </div>

    <!-- This file provides the default styling for the KeystoneJS Content Editor
      - only renders when user is logged in and admin-->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries
    //- Safely remove this block if you are not targeting IE8 -->
    <!--[if lt IE 9]>
      <script src="//cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.js"></script>
      <script src="//cdn.jsdelivr.net/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!--
      //- jQuery 1.11.3 is included by default, and required by both Bootstrap
      //- and the KeystoneJS Content Editor. If you are not targeting IE8,
      //- you can upgrade to 2.1.4 (also bundled) for better performance.
    -->
    <script>
      <!-- expose locals -->
      [[var locals = JSON.stringify(model._locals);]]
      var locals = [[=locals]];
    </script>
    <script src="/js/all-lib.js"></script>
    
    <!-- admin JS and CSS code, needs to be placed behind lib code-->
    [[var code = helpers.isAdminEditorCSS(model.user);]]
    [[=code]]
    [[var code = helpers.isAdminEditorJS(model.user);]]
    [[=code]]
    
    [[? model.env === 'production']]
    <script src="/app-dist/whole-app.js"></script>
    [[?? true]]
    <script src="/app/app.js"></script>
    <script src="/app/home/HomeCtrler.js"></script>
    <script src="/app/common/component/myAjaxMsg.js"></script>
    <script src="/app/common/filter/orFilter.js"></script>
    <script src="/app/common/service/myValidation.js"></script>

    <script src="/app/farmer/FarmerPageCtrler.js"></script>
    [[?]]

  </body>
</html>