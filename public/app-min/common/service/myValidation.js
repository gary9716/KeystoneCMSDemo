!function(){"use strict";angular.module("mainApp").service("myValidation",["$http","$rootScope","$q",function(e,t,i){this.checkPID=function(e,t){var i={};if(!e||10!==e.length)return t&&(i.message="身分證字號長度不正確",t(i)),!1;if(/^[A-Za-z][12][\d]{8}$/.test(e)||/^[A-Za-z][A-Da-d][\d]{8}$/.test(e)){var r="ABCDEFGHJKLMNPQRSTUVXYWZIO",n=[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3],s=[0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5],a=[9,8,7,6,5,4,3,2,1,1],c=0;return e.split("").forEach(function(e,t){if(0==t){var i=r.indexOf(e.toUpperCase());c=1*n[i]+s[i]*a[t]}else if(1==t){var i=r.indexOf(e.toUpperCase());if(-1!=i)c+=i*a[t];else{var o=parseInt(e);isNaN(o)?c=o:c+=o*a[t]}}else{var o=parseInt(e);isNaN(o)?c=o:c+=o*a[t]}}),c%10==0?(t&&t(),!0):(t&&(i.message="不合法身分證字號",t(i)),!1)}return t&&(i.message="含不合法字元，請檢查",t(i)),!1},this.checkPermission=function(t){if(!t)return i.reject("no parameter provided");return e.post("/api/permission",{listArray:t}).then(function(e){var t=e.data;return t.success?i.resolve("access granted"):i.reject("access denied")}).catch(function(e){return i.reject("access denied")})},this.isAdmin=function(e){return e&&e.isAdmin?i.resolve():i.reject("access denied")}}]).directive("legalpid",["myValidation",function(e){return{require:"ngModel",link:function(t,i,r,n){n.$validators.legalpid=function(t,i){return!n.$isEmpty(t)&&e.checkPID(i)}}}}])}();