!function(){"use strict";angular.module("mainApp").controller("AnnuallyWithdrawPageCtrler",["$http","$window","$rootScope","$uibModal","lodash","localStorageService","appRootPath",function(a,t,n,e,c,o,i){var s=this,r=new Date;s.cancelAWDate=r,s.downloadAWDate=r,s.doAWDate=new Date(r.getFullYear()+"/06/30"),s.doAW=function(){s.isProcessing=!0,a.post("/api/account/annually-withdraw",{code:s.code,date:s.doAWDate}).then(function(a){var t=a.data;if(t.success){var e=t.filename,c=new Blob([new Uint8Array(t.content.data)],{type:"text/plain"});saveAs(c,e),s.checkCode=t.checkCode,n.pubSuccessMsg("年度結清執行成功,已下載媒體檔")}}).catch(function(a){var t=a&&a.data?a.data.toString():a?a.toString():"";n.pubErrorMsg("年度結清執行失敗,"+t)}).finally(function(){s.isProcessing=!1})},s.cancelAW=function(){s.isProcessing=!0,a.post("/api/account/cancel-annually-withdraw",{date:s.cancelAWDate}).then(function(a){s.checkCode=void 0,a.data.success&&n.pubSuccessMsg("年度結清撤銷成功")}).catch(function(a){var t=a&&a.data?a.data.toString():a?a.toString():"";n.pubErrorMsg("年度結清撤銷失敗,"+t)}).finally(function(){s.isProcessing=!1})},s.downloadAWFile=function(){s.isProcessing=!0,a.post("/api/account/gen-annually-withdraw-file",{code:s.code,date:s.downloadAWDate}).then(function(a){var t=a.data;if(t.success){var e=t.filename,c=new Blob([new Uint8Array(t.content.data)],{type:"text/plain"});saveAs(c,e),n.pubSuccessMsg("年度結清媒體檔已下載")}}).catch(function(a){var t=a&&a.data?a.data.toString():a?a.toString():"";n.pubErrorMsg("年度結清媒體檔下載失敗,"+t)}).finally(function(){s.isProcessing=!1})}}])}();